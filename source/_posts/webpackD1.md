---
title: webpackå­¦ä¹ ç¬”è®°D1
date: 2020-02-02 22:16:40
categories:
 - [ å‰ç«¯]
tags: 
 - [ webpack]
 - [ nodejs]
---

è¯¥ç³»åˆ—æ˜¯è®°å½•webpackçš„åˆå­¦ç¬”è®°ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ å°èŠ‚ï¼šwebpack3.0 åˆè¯†ä¸å®‰è£…ã€å¿«é€Ÿåˆ›å»ºdemoã€webpackå…¥å£å’Œå‡ºå£ã€æœåŠ¡ä¸çƒ­æ›´æ–°
<!-- more -->

# ç¬¬ä¸€èŠ‚ webpack3.0 åˆè¯†ä¸å®‰è£…
> è¯¥å°èŠ‚å¯¹webpackè¿›è¡Œç®€ä»‹ï¼Œå¹¶å­¦ä¹ å¦‚ä½•å®‰è£…webpack
## ä¸€ã€webpackçš„ä½œç”¨
webpackåœ¨ä¸šç•Œçš„æµè¡Œä¸»è¦æ˜¯å› ä¸ºå‰ç«¯ç½‘é¡µåŠŸèƒ½ä¸°å¯Œï¼Œå°¤å…¶æ˜¯åœ¨SPAå•é¡µåº”ç”¨æµè¡Œåã€‚å‰ç«¯ä¸ºäº†ç®€åŒ–å¼€å‘çš„å¤æ‚åº¦å‡ºç°äº†è®¸å¤šä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚æ¨¡å—åŒ–ã€TypeScriptæ‰©å±•è¯­è¨€ã€scss lessç­‰CSSé¢„å¤„ç†å™¨ï¼Œè¿™äº›æ–¹å¼æå¤§çš„æé«˜äº†å¼€å‘æ•ˆç‡ï¼Œä½†ä»–ä»¬å¾€å¾€éœ€è¦é¢å¤–çš„å¤„ç†æ‰èƒ½å¤Ÿè¢«æµè§ˆå™¨è¯†åˆ«æ¯”å¦‚tsä»£ç è½¬ä¸ºjsï¼Œæ‰‹å·¥å¤„ç†æ˜¯éº»çƒ¦çš„ï¼Œç”±æ­¤äº§ç”Ÿäº†äº†webpackç­‰æ‰“åŒ…å·¥å…·å‡ºç°çš„éœ€æ±‚ã€‚

webpackå¯ä»¥çœ‹çœ‹ä½œæ¨¡å—æ‰“åŒ…æœºï¼Œä»–åšçš„äº‹æƒ…ç®€å•æ¥è¯´æ˜¯ï¼šåˆ†æä½ çš„é¡¹ç›®ç»“æ„-->æ‰¾åˆ°jsæ¨¡å—ä»¥åŠå…¶ä»–ä¸èƒ½è¢«æµè§ˆå™¨ç›´æ¥è¿è¡Œçš„æ‰©å±•è¯­è¨€ï¼ˆtsã€scssï¼‰-->å°†å…¶æ‰“åŒ…ä¸ºåˆé€‚æ ¼å¼ä¾›æµè§ˆå™¨ä½¿ç”¨ï¼ŒåŒæ—¶è¿˜ä¼šåšæ€§èƒ½çš„ä¼˜åŒ–

## äºŒã€å®‰è£…

***å…¨å±€å®‰è£…*** 
```
npm install -g webpack
```
å®˜æ–¹ä¸æ¨èå…¨å±€å®‰è£…webpackï¼Œå› ä¸ºå…¨å±€å®‰è£…ä¼šé”å®šwebpackç‰ˆæœ¬å¯¹äºå¤šé¡¹ç›®ä½¿ç”¨ä¸åŒç‰ˆæœ¬webpackä¸å‹å¥½

***æœ¬åœ°å®‰è£…***

åˆ›å»ºæœ¬åœ°ç©ºé¡¹ç›®
```js
  npm init
```

```js
 npm install --save-dev webpack
```
--saveæ˜¯æŒ‡è¯¥æ¨¡å—ä¼šè¿›è¡Œæœ¬åœ°å®‰è£…è¯¥ä¾èµ–ä¼šå†™å…¥åˆ°package.jsonæ–‡ä»¶ä¸­

--save-devæ˜¯æŒ‡ä¿å­˜åˆ°å¼€å‘ç¯å¢ƒï¼Œä¸è¿›å…¥ç”Ÿäº§ç¯å¢ƒ

webpackå®‰è£…å¤±è´¥æ—¶éœ€è¦æ£€æŸ¥ä¸‰ä¸ªæ–¹é¢
- nodeç‰ˆæœ¬è¿‡ä½ï¼Œ6ä»¥ä¸‹ç‰ˆæœ¬è¿‡ä½
- npmè¢«é˜»æŒ¡ï¼Œå¯ä»¥ä½¿ç”¨cnpm
- æƒé™é—®é¢˜ sudoå®‰è£…

# ç¬¬äºŒèŠ‚ å¿«é€Ÿåˆ›å»ºdemo
>è¯¥å°èŠ‚åˆ›å»ºäº†ä¸€ä¸ªæœ€ç®€å•çš„demoï¼Œç›´è§‚çš„å­¦ä¹ webpackæ‰“åŒ…çš„è¿‡ç¨‹

webpackåœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„æ—¶é—´è¾ƒå°‘ï¼ŒåŸºæœ¬åªæœ‰åœ¨é¡¹ç›®åˆæœŸä¼šä½¿ç”¨

Qï¼šå¦‚ä½•æŠŠæ—§é¡¹ç›®çš„webpackæ›´æ–°ï¼Ÿ
- æ‰“å¼€package.jsonï¼Œæ‰¾åˆ°webpackï¼Œä¿®æ”¹å¯¹åº”çš„version
- åˆ é™¤å·¥ç¨‹çš„`node_modules`æ–‡ä»¶å¤¹
- æ‰§è¡Œ`npm i`

## ä¸€ã€å»ºç«‹åŸºæœ¬çš„é¡¹ç›®ç»“æ„
æ‰“å¼€ä¸ŠèŠ‚åˆ›å»ºçš„é¡¹ç›®ï¼ˆè¿™é‡Œä½¿ç”¨vs codeå¼€å‘ç¯å¢ƒï¼‰ï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸¤ä¸ªç›®å½•srcå’Œdistï¼Œdistç›®å½•ç”¨äºå­˜æ”¾ç”Ÿäº§ç¯å¢ƒçš„ä»£ç 

demoå¦‚ä¸‹
- åœ¨distç›®å½•ä¸­åˆ›å»ºindex.html,ç®€å•çš„å†™ä¸€äº›ç½‘é¡µï¼Œå¹¶å¼•å…¥ä¸€ä¸ªåä¸º`bundle.js`çš„è„šæœ¬
```html
    <html>
        <head></head>
        <body>
            <div id = "title"></div>
            <script src ="./bundle.js"></script>
        </body>
    </html>
 ```
- åœ¨srcç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªentry.jsæ–‡ä»¶å®ç°ä¸€äº›ç®€å•åŠŸèƒ½
```js
    document.getElementById("title").innerHTML="Hello webPack";
```

## äºŒã€ä½¿ç”¨webpackè¿›è¡Œæ‰“åŒ…

æ‰“å¼€terminalè¾“å…¥å‘½ä»¤`webpack src/entry.js dist/bundle.js`ï¼Œå³å°†entry.jsæ‰“åŒ…åˆ°distç›®å½•ä¸‹bundle.js

ä½¿ç”¨live-serveråˆ›å»ºä¸€ä¸ªä¸´æ—¶æœåŠ¡ï¼ŒæŸ¥çœ‹æ•ˆæœ

```
npm install -g live-server //å®‰è£…live-server
live-server //å¯åŠ¨ä¸´æ—¶æœåŠ¡
```

å®é™…æ“ä½œdemoé‡åˆ°äº†å¦‚ä¸‹é—®é¢˜
1. `bash: webpack: command not found`ï¼Œæ‰“åŒ…æ—¶ï¼Œæç¤ºwebpack not foundï¼Œæ˜¯å› ä¸ºç›´æ¥è¾“å…¥`webpack src/entry.js dist/bundle.js`å‘½ä»¤ç›¸å½“äºåœ¨æœå¯»å…¨å±€çš„webpackï¼Œè‹¥ä½¿ç”¨npm run è‡ªå®šä¹‰å‘½ä»¤ï¼Œåˆ™æ˜¯åœ¨é¡¹ç›®çš„æ¨¡å—ä¸­æœå¯»webpackã€‚è¯¥demoä½¿ç”¨æ˜¯æœ¬åœ°å®‰è£…çš„webpackï¼Œè¿™é‡Œæ²¡æœ‰åˆ›å»ºnpm runçš„è‡ªå®šä¹‰å‘½ä»¤è§£å†³ï¼Œè€Œæ˜¯å·æ‡’ä½¿ç”¨äº†`node_modules/.bin/webpack åé¢æ¥å‚æ•°é€‰é¡¹`çš„æ–¹å¼é¿å¼€äº†é—®é¢˜ã€‚

# ç¬¬ä¸‰èŠ‚ webpackå…¥å£å’Œå‡ºå£
> è¯¥å°èŠ‚åˆ›å»ºå¹¶ç¼–å†™äº†webpackçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶é…ç½®äº†å¤šå…¥å£å¤šå‡ºå£çš„æƒ…å†µ

## ä¸€ã€ä½¿ç”¨webpack.config.jsç»“æ„
```js
    module.exports={
        entry: {},
        output: {},
        module: {}, //æ‰“åŒ…cssã€å›¾ç‰‡è½¬æ¢ã€å›¾ç‰‡å‹ç¼©ç­‰é…ç½®
        plugins: [], //
        devServer:{} //é…ç½®å¼€å‘æœåŠ¡
    }
```
## äºŒã€entryé€‰é¡¹ï¼ˆå…¥å£é…ç½®ï¼‰
```js
  entry: {
        entry: './src/entry.js'
    }
```
## ä¸‰ã€outputé€‰é¡¹ï¼ˆå‡ºå£é…ç½®ï¼‰
```js
    output: {
        path: path.resolve(__dirname,'dist'),
        filename: 'bundle.js'
    }
```
## å››ã€å¤šå…¥å£ã€å¤šå‡ºå£é…ç½®
```js
const path = require('path');

module.exports={
    entry: {
        entry: './src/entry.js',
        entry2: './src/entry2.js'
    },
    output: {
        path: path.resolve(__dirname,'dist'),
        filename: '[name].js'
    },
    module: {}, 
    plugins: [], 
    devServer:{} 
}
```

# ç¬¬å››èŠ‚ æœåŠ¡ä¸çƒ­æ›´æ–°
>
ç½‘ç»œä¸å¤ªå¥½ï¼Œè¿™é‡Œæ¢æˆcnpmå®‰è£…ä¾èµ–äº†
```
npm install cnpm -g --registry=https://registry.npm.taobao.org 
```

ä½¿ç”¨webpackæä¾›çš„webpack-dev-serverå·¥å…·å¯ä»¥åœ¨å¼€å‘ç¯å¢ƒä¸­æ­å»ºæœåŠ¡ï¼Œå¹¶å®ç°æœåŠ¡çš„çƒ­æ›´æ–°

é¦–å…ˆå®‰è£…webpack-dev-serverï¼Œè¿™é‡Œä½¿ç”¨äº†2.Xç‰ˆæœ¬æ˜¯å› ä¸º3.Xç‰ˆæœ¬è²Œä¼¼éœ€è¦å®‰è£…webpack-cliï¼Œç„¶åå®‰è£…åå·¥ç¨‹æ‰“åŒ…æœ‰äº›é—®é¢˜æ²¡æœ‰æ·±å…¥ç ”ç©¶ğŸ˜‚ã€‚

```
cnpm install webpack-dev-server@2.8.2 --save-dev
```

ä¿®æ”¹é…ç½®æ–‡ä»¶
```js
module.exports={
    entry: {
        entry: './src/entry.js',
        entry2: './src/entry2.js'
    },
    output: {
        path: path.resolve(__dirname,'dist'),
        filename: '[name].js'
    },
    module: {}, //æ‰“åŒ…cssã€å›¾ç‰‡è½¬æ¢ã€å›¾ç‰‡å‹ç¼©ç­‰é…ç½®
    plugins: [], //
    devServer:{
        contentBase:path.resolve(__dirname,'dist'), //åŸºæœ¬ç›®å½•ç»“æ„ï¼šç›‘å¬å“ªæ®µä»£ç 
        host:'localhost',
        compress:true,//æœåŠ¡å™¨å‹ç¼©
        port:80,
    } 
}
```
åˆ›å»ºnpm è‡ªå®šä¹‰å‘½ä»¤
```json
  "scripts": {
    "server": "webpack-dev-server"
  },
```
